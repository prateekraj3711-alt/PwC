services:
  - type: web
    name: pwc-export-service
    env: python
    runtime: python-3.11.10
    plan: free
    rootDir: ""
    autoDeploy: true
    region: oregon
    healthCheckPath: /health
    buildCommand: |
      apt-get update
      apt-get install -y wget gnupg ca-certificates fonts-liberation libasound2 libatk-bridge2.0-0 libcups2 libdbus-1-3 libdrm2 libgbm1 libgtk-3-0 libnspr4 libnss3 libx11-xcb1 libxcomposite1 libxdamage1 libxrandr2 xdg-utils
      pip install --upgrade pip setuptools wheel
      pip install --prefer-binary -r requirements.txt
      python -m playwright install chromium
    startCommand: uvicorn export_dashboard:app --host 0.0.0.0 --port $PORT

